<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Aurevia AI</title>

<style>
:root{
  --accent:#38bdf8;
  --bg:#0f172a;
  --panel:#111827;
  --soft:#1f2933;
  --white:#ffffff;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: "Inter", system-ui, sans-serif;
  background:var(--bg);
  color:white;
  height:100vh;
  display:flex;
  flex-direction:column;
}

/* ===== TOP NAV ===== */
header{
  height:52px;
  background:white;
  color:black;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 16px;
  font-weight:600;
}

header nav a{
  margin:0 8px;
  text-decoration:none;
  color:black;
  padding:6px 12px;
  border-radius:6px;
}

header nav a.active,
header nav a:hover{
  background:var(--accent);
}

/* ===== LAYOUT ===== */
#main{
  flex:1;
  display:flex;
  overflow:hidden;
}

/* ===== SIDEBAR ===== */
#sidebar{
  width:220px;
  background:var(--panel);
  padding:10px;
  display:flex;
  flex-direction:column;
}

#sidebar input{
  padding:8px;
  border-radius:6px;
  border:none;
  margin-bottom:8px;
}

#sessions{
  flex:1;
  overflow-y:auto;
}

.session{
  background:var(--soft);
  padding:8px;
  border-radius:8px;
  margin-bottom:6px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  cursor:pointer;
}

.session span{
  font-size:14px;
}

.session .icons{
  display:flex;
  gap:6px;
}

.session .icons button{
  background:none;
  border:none;
  color:white;
  cursor:pointer;
}

/* ===== CHAT ===== */
#chat{
  flex:1;
  display:flex;
  flex-direction:column;
  padding:12px;
}

#messages{
  flex:1;
  overflow-y:auto;
}

.msg{
  max-width:78%;
  padding:10px 12px;
  border-radius:12px;
  margin-bottom:8px;
  line-height:1.4;
}

.user{
  background:var(--accent);
  color:black;
  align-self:flex-end;
}

.ai{
  background:#1e293b;
  align-self:flex-start;
  position:relative;
}

.pin{
  position:absolute;
  right:6px;
  top:6px;
  cursor:pointer;
}

/* ===== INPUT ===== */
#inputBar{
  display:flex;
  margin-top:8px;
}

#inputBar input{
  flex:1;
  padding:12px;
  border-radius:10px;
  border:none;
}

#inputBar button{
  margin-left:6px;
  padding:12px 16px;
  border:none;
  border-radius:10px;
  background:var(--accent);
  cursor:pointer;
}

/* MOBILE */
@media(max-width:700px){
  #sidebar{width:160px}
}
</style>
</head>

<body>

<header>
  <div>Aurevia ✨</div>
  <nav>
    <a class="active">AI</a>
    <a href="notes.html">Notes</a>
    <a href="focus.html">Focus</a>
    <a href="home.html">Home</a>
  </nav>
</header>

<div id="main">

<!-- SIDEBAR -->
<div id="sidebar">
  <input placeholder="Search chats…" oninput="searchChats(this.value)" />
  <button onclick="newChat()">+ New Chat</button>
  <div id="sessions"></div>
</div>

<!-- CHAT -->
<div id="chat">
  <div id="messages"></div>

  <div id="inputBar">
    <input id="input" placeholder="Ask Aurevia…" />
    <button onclick="send()">Send</button>
  </div>
</div>

</div>
<script>
let chats = JSON.parse(localStorage.getItem("aureviaChats") || "[]");
let current = Number(localStorage.getItem("aureviaCurrent") ?? -1);

/* ===== SAVE ===== */
function save() {
  localStorage.setItem("aureviaChats", JSON.stringify(chats));
  localStorage.setItem("aureviaCurrent", current);
}

/* ===== NEW CHAT ===== */
function newChat() {
  chats.push({ name: `Chat ${chats.length + 1}`, messages: [] });
  current = chats.length - 1;
  save();
  render();
}

/* ===== RENAME ===== */
function renameChat(i) {
  const n = prompt("Rename chat", chats[i].name);
  if (n) {
    chats[i].name = n;
    save();
    render();
  }
}

/* ===== RENDER SESSIONS ===== */
function render() {
  const s = document.getElementById("sessions");
  s.innerHTML = "";

  chats.forEach((c, i) => {
    const d = document.createElement("div");
    d.className = "session";
    d.onclick = () => {
      current = i;
      save();
      renderMessages();
    };

    d.innerHTML = `
      <span>${c.name}</span>
      <button onclick="event.stopPropagation();renameChat(${i})">✏️</button>
    `;

    s.appendChild(d);
  });

  renderMessages();
}

/* ===== RENDER MESSAGES ===== */
function renderMessages() {
  const m = document.getElementById("messages");
  m.innerHTML = "";

  if (current < 0) return;

  chats[current].messages.forEach(msg => {
    const d = document.createElement("div");
    d.className = "msg " + msg.role;
    d.innerText = msg.text;
    m.appendChild(d);
  });

  m.scrollTop = m.scrollHeight;
}

/* ===== SEND MESSAGE ===== */
async function send() {
  const input = document.getElementById("input");
  const text = input.value.trim();
  if (!text || current < 0) return;

  input.value = "";

  chats[current].messages.push({ role: "user", text });
  chats[current].messages.push({ role: "ai", text: "Thinking..." });
  renderMessages();
  save();

  try {
    const res = await fetch("https://aurevia-7sxo.onrender.com/ask-ai", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question: text })
    });

    const data = await res.json();
    chats[current].messages.pop();
    chats[current].messages.push({
      role: "ai",
      text: data.answer || data.reply || "No response"
    });

  } catch (e) {
    chats[current].messages.pop();
    chats[current].messages.push({
      role: "ai",
      text: "⚠️ AI unavailable"
    });
  }

  renderMessages();
  save();
}

/* ===== INIT ===== */
render();
</script>

</body>
</html>





